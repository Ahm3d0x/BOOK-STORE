
const SCRIPT_PROP = PropertiesService.getScriptProperties();

// ==========================================
// 1. Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø·Ù„Ø¨Ø§Øª (GET)
// ==========================================
function doGet(e) {
  const lock = LockService.getScriptLock();
  // Ù†Ù†ØªØ¸Ø± 10 Ø«ÙˆØ§Ù†ÙŠ ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙÙ„ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆÙ„ÙƒÙ† Ø¬ÙŠØ¯ Ù„Ù„Ø£Ù…Ø§Ù†)
  lock.tryLock(10000); 

  let result = {};
  
  try {
    const action = e.parameter ? e.parameter.action : '';
    const db = getDb();

    if (!action) throw new Error("No action specified");

    switch(action) {
      case 'getBooks':
        // ÙŠØ¬Ù„Ø¨ Ø§Ù„ÙƒØªØ¨ ÙˆÙŠØ±ØªØ¨Ù‡Ø§ Ø¨Ø­ÙŠØ« Ø§Ù„Ø£Ø­Ø¯Ø« ÙŠØ¸Ù‡Ø± Ø£ÙˆÙ„Ø§Ù‹
        result = getData(db.books).reverse(); 
        break;

      case 'getSettings':
        const settingsArr = getData(db.settings);
        // ÙŠØ­ÙˆÙ„ Ù…ØµÙÙˆÙØ© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¥Ù„Ù‰ ÙƒØ§Ø¦Ù† JSON Ø¨Ø³ÙŠØ· {key: value}
        result = settingsArr.reduce((acc, curr) => {
          if(curr.key) acc[curr.key] = curr.value;
          return acc;
        }, {});
        break;

      case 'getOrders':
         result = getData(db.orders).reverse();
         break;

      case 'getSlider':
         result = getData(db.slider);
         break;

      case 'ping':
         result = { status: 'alive', time: new Date().toString() };
         break;

      default:
        result = { error: 'Invalid Action' };
    }

  } catch (err) {
    result = { error: err.toString(), stack: err.stack };
  } finally {
    lock.releaseLock();
  }

  return sendJSON(result);
}

// ==========================================
// 2. Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ÙƒØªØ§Ø¨Ø© (POST)
// ==========================================
function doPost(e) {
  const lock = LockService.getScriptLock();
  // Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹: Ù†Ù†ØªØ¸Ø± Ø­ØªÙ‰ 30 Ø«Ø§Ù†ÙŠØ© Ù„Ù…Ù†Ø¹ ØªØ¶Ø§Ø±Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
  // Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ù‚ÙÙ„ØŒ Ø³ÙŠØ¹ÙŠØ¯ Ø®Ø·Ø£ ÙˆÙ„Ù† ÙŠÙØ³Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  if (!lock.tryLock(30000)) {
    return sendJSON({ error: "Server is busy, please try again." });
  }

  let result = {};

  try {
    if (!e.postData || !e.postData.contents) throw new Error("No data received");
    
    const requestData = JSON.parse(e.postData.contents);
    const action = e.parameter.action;
    const db = getDb();

    switch(action) {
      // ----------------------
      // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒØªØ¨
      // ----------------------
      case 'addBook':
        requestData.id = requestData.id || Date.now().toString();
        requestData.date_added = new Date().toLocaleDateString('en-GB');
        // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø­Ø§Ù„Ø© ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†
        requestData.status = Number(requestData.stock) > 0 ? 'Ù…ØªÙˆÙØ±' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±';
        addRowDynamic(db.books, requestData);
        result = { success: true, message: 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒØªØ§Ø¨ Ø¨Ù†Ø¬Ø§Ø­' };
        break;

      case 'updateBook':
        if(requestData.stock !== undefined) {
             requestData.status = Number(requestData.stock) > 0 ? 'Ù…ØªÙˆÙØ±' : 'ØºÙŠØ± Ù…ØªÙˆÙØ±';
        }
        updateRowDynamic(db.books, 'id', requestData.id, requestData);
        result = { success: true, message: 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒØªØ§Ø¨' };
        break;

      case 'deleteBook':
        deleteRowDynamic(db.books, 'id', requestData.id);
        result = { success: true, message: 'ØªÙ… Ø­Ø°Ù Ø§Ù„ÙƒØªØ§Ø¨' };
        break;

      // ----------------------
      // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Ø§Ù„Ø£ÙƒØ«Ø± Ø­Ø³Ø§Ø³ÙŠØ©)
      // ----------------------
      case 'placeOrder':
        // 1. Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        if (!requestData.cartData) throw new Error("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©");
        
        // 2. ØªØ¬Ù‡ÙŠØ² Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        const orderId = 'ORD-' + Math.floor(100000 + Math.random() * 900000);
        const orderDate = new Date().toLocaleString('en-GB');
        
        const newOrder = {
          order_id: orderId,
          date: orderDate,
          customer_name: requestData.customer_name,
          phone: requestData.phone,
          email: requestData.email,
          address: requestData.address,
          items: requestData.items, // Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª
          total_price: requestData.total_price,
          status: 'Ø¬Ø¯ÙŠØ¯',
          date_preparing: '',
          date_shipped: '',
          date_delivered: '',
          date_cancelled: '',
          governorate: requestData.governorate,
          shipping_cost: requestData.shipping_cost // Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯
        };

        // 3. Ø®ØµÙ… Ø§Ù„Ù…Ø®Ø²ÙˆÙ† (Critical Section)
        const cartItems = typeof requestData.cartData === 'string' ? JSON.parse(requestData.cartData) : requestData.cartData;
        const booksSheet = db.books;
        const booksData = booksSheet.getDataRange().getValues();
        const headers = booksData[0];
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
        const idIdx = headers.indexOf('id');
        const stockIdx = headers.indexOf('stock');
        const statusIdx = headers.indexOf('status');

        if (idIdx === -1 || stockIdx === -1) throw new Error("ØªÙ†Ø³ÙŠÙ‚ Ø´ÙŠØª Ø§Ù„ÙƒØªØ¨ ØºÙŠØ± ØµØ­ÙŠØ­");

        // Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø®ØµÙ…
        cartItems.forEach(item => {
           for (let i = 1; i < booksData.length; i++) {
             // Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù€ ID (ÙƒÙ€ String Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø¯Ù‚Ø©)
             if (String(booksData[i][idIdx]) === String(item.id)) {
               let currentStock = Number(booksData[i][stockIdx] || 0);
               let newStock = currentStock - Number(item.qty || 0);
               
               if (newStock < 0) newStock = 0; // Ù…Ù†Ø¹ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø³Ø§Ù„Ø¨
               
               // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ù„ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø©
               booksSheet.getRange(i + 1, stockIdx + 1).setValue(newStock);
               
               // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ø¥Ø°Ø§ Ù†ÙØ°Øª Ø§Ù„ÙƒÙ…ÙŠØ©
               if (newStock === 0 && statusIdx > -1) {
                  booksSheet.getRange(i + 1, statusIdx + 1).setValue('ØºÙŠØ± Ù…ØªÙˆÙØ±');
               }
               break; // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…Ù†ØªØ¬ Ø§Ù„ØªØ§Ù„ÙŠ
             }
           }
        });

        // 4. Ø­ÙØ¸ Ø§Ù„Ø·Ù„Ø¨
        addRowDynamic(db.orders, newOrder);

        // 5. Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª (Ø¯Ø§Ø®Ù„ Try-Catch Ù…Ù†ÙØµÙ„ Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ÙØ´Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„)
        try {
           sendEmails(newOrder, db.settings);
        } catch(emailErr) {
           console.warn("Email failed: " + emailErr);
        }

        result = { success: true, message: 'ØªÙ… Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­', orderId: orderId };
        break;

      case 'updateOrderStatus':
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØªÙˆØ§Ø±ÙŠØ® Ø§Ù„ØªØªØ¨Ø¹
        const statusMap = {
            'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±': 'date_preparing',
            'ØªÙ… Ø§Ù„Ø´Ø­Ù†': 'date_shipped',
            'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…': 'date_delivered',
            'Ù…Ù„ØºÙŠ': 'date_cancelled'
        };
        
        const updateData = { status: requestData.status };
        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø­Ø§Ù„Ø© ØªØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ ØªØ§Ø±ÙŠØ®ØŒ Ù†Ø¶ÙŠÙÙ‡
        if (statusMap[requestData.status]) {
            updateData[statusMap[requestData.status]] = new Date().toLocaleString('en-GB');
        }
        
        updateRowDynamic(db.orders, 'order_id', requestData.order_id, updateData);
        result = { success: true, message: 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨' };
        break;

      case 'deleteOrder':
         deleteRowDynamic(db.orders, 'order_id', requestData.order_id);
         result = { success: true, message: 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨' };
         break;

      // ----------------------
      // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±
      // ----------------------
      case 'updateSettings':
         const sSheet = db.settings;
         // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø¯ÙŠÙ… ÙˆÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯
         if (sSheet.getLastRow() > 1) {
             sSheet.getRange(2, 1, sSheet.getLastRow() - 1, sSheet.getLastColumn()).clearContent();
         }
         const newSettingsRows = [];
         for (const [k, v] of Object.entries(requestData)) {
             if(k !== 'action') newSettingsRows.push([k, v]);
         }
         if(newSettingsRows.length > 0) sSheet.getRange(2, 1, newSettingsRows.length, 2).setValues(newSettingsRows);
         result = { success: true, message: 'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' };
         break;

      case 'addSlider':
         requestData.id = Date.now().toString();
         requestData.active = 'TRUE';
         addRowDynamic(db.slider, requestData);
         result = { success: true };
         break;
         
      case 'updateSlider':
         updateRowDynamic(db.slider, 'id', requestData.id, requestData);
         result = { success: true };
         break;
         
      case 'deleteSlider':
         deleteRowDynamic(db.slider, 'id', requestData.id);
         result = { success: true };
         break;

      default:
        throw new Error("Invalid Action Type");
    }

  } catch (err) {
    result = { error: err.toString(), stack: err.stack };
  } finally {
    lock.releaseLock();
  }

  return sendJSON(result);
}

// ==========================================
// 3. Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø´ÙŠØª (Helper Functions)
// ==========================================

function getDb() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  return {
    books: ss.getSheetByName('Books'),
    orders: ss.getSheetByName('Orders'),
    settings: ss.getSheetByName('Settings'),
    slider: ss.getSheetByName('Slider')
  };
}

// Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ€ JSON
function sendJSON(data) {
  return ContentService.createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}

// Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
function getData(sheet) {
  const rows = sheet.getDataRange().getValues();
  if (rows.length < 2) return []; // ÙÙ‚Ø· Ø§Ù„Ù‡ÙŠØ¯Ø± Ù…ÙˆØ¬ÙˆØ¯
  const headers = rows.shift(); // Ø³Ø­Ø¨ Ø§Ù„Ù‡ÙŠØ¯Ø±
  
  return rows.map(row => {
    let obj = {};
    headers.forEach((header, i) => {
      let val = row[i];
      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„Ù†Øµ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„
      if (val instanceof Date) {
         val = val.toLocaleString('en-GB'); 
      }
      obj[header] = val;
    });
    return obj;
  });
}

// Ø¥Ø¶Ø§ÙØ© ØµÙ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© (Ø§Ù„Ø£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ø§Ù‹)
function addRowDynamic(sheet, dataObj) {
  const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
  const newRow = headers.map(header => {
    // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ø§Ù„Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Ù†Ø¶Ø¹ Ù†Øµ ÙØ§Ø±Øº
    let val = dataObj[header];
    return (val !== undefined && val !== null) ? val : '';
  });
  sheet.appendRow(newRow);
}

// ØªØ­Ø¯ÙŠØ« ØµÙ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…Ø¹Ø±Ù
function updateRowDynamic(sheet, idColName, idValue, dataObj) {
  const data = sheet.getDataRange().getValues();
  const headers = data[0];
  const idIdx = headers.indexOf(idColName);
  
  if (idIdx === -1) return;

  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ØµÙ
  for (let i = 1; i < data.length; i++) {
    if (String(data[i][idIdx]) === String(idValue)) {
      // Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø®Ù„ÙŠØ© Ø¨Ø®Ù„ÙŠØ© Ù„Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙ‚Ø·
      headers.forEach((header, colIdx) => {
        if (dataObj.hasOwnProperty(header)) {
           sheet.getRange(i + 1, colIdx + 1).setValue(dataObj[header]);
        }
      });
      return;
    }
  }
}

// Ø­Ø°Ù ØµÙ
function deleteRowDynamic(sheet, idColName, idValue) {
  const data = sheet.getDataRange().getValues();
  const headers = data[0];
  const idIdx = headers.indexOf(idColName);
  
  if (idIdx === -1) return;

  for (let i = 1; i < data.length; i++) {
    if (String(data[i][idIdx]) === String(idValue)) {
      sheet.deleteRow(i + 1);
      return;
    }
  }
}

// ==========================================
// 4. Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª (Ù…Ø­Ø³Ù†Ø©)
// ==========================================
function sendEmails(orderData, settingsSheet) {
    // Ø¬Ù„Ø¨ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„
    let siteName = 'Ù…ØªØ¬Ø± Ø§Ù„ÙƒØªØ¨';
    let adminEmail = '';
    
    try {
        const settings = getData(settingsSheet);
        settings.forEach(s => {
            if(s.key === 'site_name') siteName = s.value;
            // Ù†ÙØªØ±Ø¶ Ø£Ù† Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‡Ùˆ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø°ÙŠ Ù…ÙØªØ§Ø­Ù‡ admin_email Ø£Ùˆ Ù†Ø£Ø®Ø°Ù‡ Ù…Ù† Ø§Ù„ØµÙ Ø§Ù„Ø±Ø§Ø¨Ø¹ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚
        });
        // Ù‚Ø±Ø§Ø¡Ø© Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…Ø¨Ø§Ø´Ø±Ø© (Ø§Ø­ØªÙŠØ§Ø·ÙŠ)
        adminEmail = settingsSheet.getRange(4, 2).getValue();
    } catch(e) {}

    const subject = `Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯: ${orderData.order_id}`;
    
    // Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ø§Ù„Ø¨Ø³ÙŠØ· ÙˆØ§Ù„ÙØ¹Ø§Ù„
    const htmlBody = `
      <div dir="rtl" style="font-family: sans-serif; padding: 20px; border: 1px solid #eee;">
         <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${orderData.customer_name}</h2>
         <p>ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø±Ù‚Ù… <b>${orderData.order_id}</b> Ø¨Ù†Ø¬Ø§Ø­.</p>
         <hr>
         <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨:</h3>
         <p><b>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</b> ${orderData.items}</p>
         <p><b>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</b> ${orderData.total_price}</p>
         <p><b>Ø§Ù„Ø´Ø­Ù†:</b> ${orderData.shipping_cost} Ø¬.Ù…</p>
         <hr>
         <p>Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø´Ø­Ù†.</p>
         <p>Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ³ÙˆÙ‚Ùƒ Ù…Ø¹Ù†Ø§!</p>
      </div>
    `;

    // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¹Ù…ÙŠÙ„
    if(orderData.email && orderData.email.includes('@')) {
        MailApp.sendEmail({
            to: orderData.email,
            subject: `âœ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ${orderData.order_id} - ${siteName}`,
            htmlBody: htmlBody
        });
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©
    if(adminEmail && adminEmail.includes('@')) {
        MailApp.sendEmail({
            to: adminEmail,
            subject: `ğŸ”” ${subject}`,
            htmlBody: htmlBody + `<br><br><b>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„:</b><br>Ù‡Ø§ØªÙ: ${orderData.phone}<br>Ø¹Ù†ÙˆØ§Ù†: ${orderData.address}`
        });
    }
}


function authorizeEmail() {
  MailApp.getRemainingDailyQuota();
  console.log("ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¨Ù†Ø¬Ø§Ø­!");
}